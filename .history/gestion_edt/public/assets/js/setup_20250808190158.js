document.addEventListener("DOMContentLoaded",function(){let e=[document.getElementById("step1"),document.getElementById("step2"),document.getElementById("step3"),document.getElementById("step4")],t=document.getElementById("progress-line-filled"),a=[document.getElementById("progress-circle-1"),document.getElementById("progress-circle-2"),document.getElementById("progress-circle-3"),document.getElementById("progress-circle-4")],n=[document.getElementById("progress-label-1"),document.getElementById("progress-label-2"),document.getElementById("progress-label-3"),document.getElementById("progress-label-4")],s={1:document.getElementById("step1NextBtn"),2:document.getElementById("step2NextBtn"),3:document.getElementById("step3NextBtn")},i={2:document.getElementById("step2PrevBtn"),3:document.getElementById("step3PrevBtn"),4:document.getElementById("step4PrevBtn")},l=document.getElementById("finishSetupBtn"),d=document.getElementById("excelFile"),r=document.getElementById("upload-area"),c=document.getElementById("fileName"),o=document.getElementById("step1-feedback"),m=document.getElementById("formateurs-table-body"),u=document.getElementById("step4-feedback"),f=1,v=flatpickr("#holidays-picker",{mode:"multiple",dateFormat:"d/m/Y",locale:"fr",onChange:e=>(function e(t,a){let n=document.getElementById(`${t}-tags`);n.innerHTML="",a.forEach(e=>E(t,e))})("holidays",e.map(e=>v.formatDate(e,"d/m/Y")))}),p=flatpickr("#vacations-picker",{mode:"range",dateFormat:"d/m/Y",locale:"fr"});function g(s){e.forEach(e=>e.classList.remove("active")),e[s-1].classList.add("active"),function s(i){let l=e.length;t.style.width=`${(i-1)/(l-1)*100}%`;for(let d=0;d<l;d++)d<i-1?(a[d].classList.add("completed"),a[d].classList.remove("active"),n[d].classList.add("completed")):d===i-1?(a[d].classList.add("active"),a[d].classList.remove("completed"),n[d].classList.add("active"),n[d].classList.remove("completed")):(a[d].classList.remove("active","completed"),n[d].classList.remove("active","completed"))}(s),f=s}function E(e,t){let a=document.getElementById(`${e}-tags`);if(Array.from(a.querySelectorAll(".tag")).some(e=>e.dataset.value===t))return;let n=document.createElement("div");n.className="tag",n.dataset.value=t,n.innerHTML=`${t} <button><i class="fas fa-times"></i></button>`,n.querySelector("button").addEventListener("click",function(){n.remove(),"holidays"===e&&v.setDate(function e(t){let a=document.getElementById(`${t}-tags`);return Array.from(a.querySelectorAll(".tag")).map(e=>e.dataset.value)}("holidays"),!0)}),a.appendChild(n)}s[1].addEventListener("click",()=>(function e(){if(!d.files[0]){o.textContent="Veuillez s\xe9lectionner un fichier.",o.classList.remove("hidden");return}s[1].innerHTML='Analyse... <i class="fas fa-spinner fa-spin ml-2"></i>',s[1].disabled=!0,setTimeout(()=>{var e;e=[{nom:"Alexandre Martin",masse_horaire:120,matricule:"M001",email:"alex.martin@example.com"},{nom:"Sophie Dubois",masse_horaire:90,matricule:"M002",email:"sophie.dubois@example.com"},{nom:"Thomas Bernard",masse_horaire:150,matricule:"M003",email:"thomas.bernard@example.com"},{nom:"Marie Lefevre",masse_horaire:110,matricule:"M004",email:"marie.lefevre@example.com"},{nom:"Jean Petit",masse_horaire:85,matricule:"M005",email:"jean.petit@example.com"}],m.innerHTML="",e.forEach(e=>{let t=document.createElement("tr");t.innerHTML=`
                        <td class="font-semibold text-gray-800 nom">${e.nom}</td>
                        <td><input type="number" class="form-input masse_horaire" value="${e.masse_horaire}"></td>
                        <td><input type="text" class="form-input matricule" value="${e.matricule}" readonly></td>
                        <td><input type="email" class="form-input email" value="${e.email}"></td>
                    `,m.appendChild(t)}),g(2),s[1].innerHTML='Suivant <i class="fas fa-arrow-right ml-2"></i>',s[1].disabled=!1},1500)})()),s[2].addEventListener("click",()=>g(3)),s[3].addEventListener("click",()=>g(4)),i[2].addEventListener("click",()=>g(1)),i[3].addEventListener("click",()=>g(2)),i[4].addEventListener("click",()=>g(3)),r.addEventListener("click",()=>d.click()),d.addEventListener("change",function(){if(this.files.length>0){let e=this.files[0];c.textContent=e.name,s[1].disabled=!1,o.classList.add("hidden")}}),document.getElementById("add-vacation-btn").addEventListener("click",function(){let e=document.getElementById("vacation-name-input"),t=e.value.trim(),a=p.selectedDates;if(!t){document.getElementById("vacation-feedback").textContent="Veuillez saisir un nom pour les vacances.",document.getElementById("vacation-feedback").classList.remove("hidden");return}if(2!==a.length){document.getElementById("vacation-feedback").textContent="Veuillez s\xe9lectionner une p\xe9riode valide.",document.getElementById("vacation-feedback").classList.remove("hidden");return}document.getElementById("vacation-feedback").classList.add("hidden");let n=p.formatDate(a[0],"d/m/Y"),s=p.formatDate(a[1],"d/m/Y"),i=`${t} (${n} - ${s})`;E("vacations",i),e.value="",p.clear()}),setTimeout(()=>{v.setDate(["01/01/2024","11/01/2024","01/05/2024","30/07/2024","14/08/2024","20/08/2024","21/08/2024","28/11/2024","25/12/2024"],!0)},500);let y=document.getElementById("espace-input"),L=document.getElementById("ajouter-espace"),$=document.getElementById("espaces-container"),h=document.getElementById("suggestions-container"),B=["Salle A101","Amphi B","Labo Info","TEAMS","ZOOM"];function _(e){if(!(e=e.trim()))return;let t=Array.from($.querySelectorAll(".tag"));if(t.some(t=>t.dataset.value===e))return;let a=document.createElement("div");a.className="tag",a.dataset.value=e,a.innerHTML=`${e} <button><i class="fas fa-times"></i></button>`,a.querySelector("button").addEventListener("click",function(){a.remove()}),$.appendChild(a),y.value="",h.classList.add("hidden")}L.addEventListener("click",()=>_(y.value)),y.addEventListener("keypress",function(e){"Enter"===e.key&&(e.preventDefault(),_(y.value))}),y.addEventListener("input",function(){let e=this.value.trim().toLowerCase();if(!e){h.classList.add("hidden");return}let t=B.filter(t=>t.toLowerCase().includes(e)&&!Array.from($.querySelectorAll(".tag")).some(e=>e.dataset.value===t));if(0===t.length){h.classList.add("hidden");return}h.innerHTML="",t.forEach(e=>{let t=document.createElement("div");t.className="suggestion-item",t.textContent=e,t.addEventListener("click",()=>{_(e)}),h.appendChild(t)}),h.classList.remove("hidden")}),document.addEventListener("click",function(e){h.contains(e.target)||h.classList.add("hidden")}),document.querySelectorAll("#common-spaces button").forEach(e=>{e.addEventListener("click",function(){_(this.dataset.space)})}),l.addEventListener("click",function(){let e=Array.from($.querySelectorAll(".tag")).map(e=>e.dataset.value);if(0===e.length){u.textContent="Veuillez ajouter au moins un espace.",u.classList.remove("hidden");return}this.innerHTML='Sauvegarde... <i class="fas fa-spinner fa-spin ml-2"></i>',this.disabled=!0,setTimeout(()=>{a[3].classList.remove("active"),a[3].classList.add("success"),n[3].classList.add("completed"),u.textContent="Configuration termin\xe9e avec succ\xe8s !",u.classList.remove("feedback-error","hidden"),u.classList.add("feedback-success"),setTimeout(()=>{this.innerHTML='Terminer <i class="fas fa-check ml-2"></i>',this.disabled=!1},2e3)},1500)}),g(1)});