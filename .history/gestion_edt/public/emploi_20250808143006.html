<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Système d'Emploi du Temps avec Excel</title>
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    /* ... (tous les styles précédents restent ici, SAUF les styles pour .alert-box et .btn-save) ... */
    
    /* ============================================================== */
    /* ==   NOUVEAUX STYLES AMÉLIORÉS POUR LE CALENDRIER PERSONNALISÉ   == */
    /* ============================================================== */
    .week-selection {
      display: flex;
      justify-content: center;
      margin: auto;
      gap: 10px;
      align-items: center;
    }

    .week-import-btn {
      position: relative;
      display: inline-block;
    }

    .week-import-menu {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      background: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      z-index: 1100;
      min-width: 250px;
      max-height: 300px;
      overflow-y: auto;
      padding: 10px;
      margin-top: 5px;
    }

    .week-import-menu.show {
      display: block;
      animation: fadeInScaleUp 0.2s ease-out;
    }

    .week-import-item {
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.2s;
      font-size: 0.95rem;
      margin-bottom: 3px;
    }

    .week-import-item:hover {
      background-color: #f0f4ff;
    }

    .week-import-item.selected {
      background-color: #3498db;
      color: white;
    }

    .btn-import {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 8px 12px 8px 16px;
      gap: 8px;
      height: 43px;
      border: none;
      background: #000000d4;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .btn-import:hover {
      background: #0f0d0f4d;
    }

    .svg-icon-import {
      width: 20px;
      height: 20px;
      stroke: #ffffff;
    }

    .lable-import {
      margin-top: 1px;
      font-weight: bold;
      font-size: 15px;
      line-height: 22px;
      color: #ffffff;
      letter-spacing: 1px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Helvetica, Arial, sans-serif;
    }

/* NOUVEAU STYLE CORRIGÉ */
.upload {
  display: flex;
  align-items: center;
  justify-content: center; /* Centre tous les boutons */
  gap: 15px; /* Augmente légèrement l'espace pour une meilleure lisibilité */
  margin-top: 30px;
  margin-left: 30px;
  margin-right: 30px;
  padding-bottom: 10px; /* Empêche la barre de défilement de coller aux boutons */
}   

.week-selection {
  display: flex;
  justify-content: center;
  /* margin: auto; a été supprimé */
  gap: 10px;
  align-items: center;
}

.custom-week-picker {
    position: relative;
    min-width: 250px;
    /* margin-left: 320px; a été supprimé */
}
  

    #customWeekDisplay {
        padding: 10px 15px;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-size: 1.1rem;
        background-color: #fff;
        cursor: pointer;
        text-align: center;
        user-select: none;
        transition: all 0.2s ease-in-out;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        display: flex; /* Active Flexbox */
        align-items: center; /* Aligne verticalement l'icône et le texte */
        justify-content: center; /* Centre le contenu horizontalement */
        gap: 20px; /* Crée un espace entre l'icône et le texte */
        height: 43px;
    }

    #customWeekDisplay img {
        height: 25px;
        width: auto;
    }

    @keyframes fadeInScaleUp {
      from {
        opacity: 0;
        transform: translateX(-50%) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateX(-50%) scale(1);
      }
    }

    #calendarPopup {
        display: none;
        position: absolute;
        top: calc(100% + 5px);
        left: 50%;
        transform: translateX(-50%);
        width: 320px;
        background: #fff;
        border: 1px solid #e0e0e0;
        border-radius: 10px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        z-index: 1200;
        padding: 15px;
        animation: fadeInScaleUp 0.2s ease-out;
    }

    .calendar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-bottom: 10px;
        margin-bottom: 10px;
        border-bottom: 1px solid #f0f0f0;
    }
    .calendar-header button {
        background: none;
        border: none;
        font-size: 1rem;
        cursor: pointer;
        color: #555;
        border-radius: 50%;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.2s;
    }
    .calendar-header button:hover {
        background-color: #f0f4ff;
        color: #3498db;
    }
    .calendar-title {
        font-weight: 600;
        font-size: 1.1rem;
        color: #2c3e50;
    }

    .calendar-grid {
        width: 100%;
        border-collapse: collapse;
        text-align: center;
    }
    .calendar-grid th {
        font-size: 0.8rem;
        color: #95a5a6;
        padding-bottom: 10px;
        font-weight: 600;
        text-transform: uppercase;
    }
    .calendar-grid td {
        padding: 2px;
    }
    .calendar-day {
        width: 100%;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 0.95rem;
        border: 1px solid transparent;
    }
    .calendar-day:hover {
        background-color: #f0f4ff;
        transform: scale(1.05);
    }
    .calendar-day.other-month {
        opacity: 0.4;
    }
    .calendar-day.disabled-day {
        color: #bdc3c7;
        background-color: #f9f9f9;
        cursor: not-allowed;
    }
     .calendar-day.disabled-day:hover {
        background-color: #f9f9f9;
        transform: none;
    }
    .calendar-day.today {
        border-color: #3498db;
        color: #3498db;
        font-weight: bold;
    }
    
    /* Style pour la semaine sélectionnée */
    .calendar-day.selected-in-range {
        background-color: #eaf5ff;
        color: #2980b9;
        border-radius: 0;
    }
    .calendar-day.selected-start {
        background-color: #3498db;
        color: #fff;
        border-top-left-radius: 20px;
        border-bottom-left-radius: 20px;
    }
    .calendar-day.selected-end {
        background-color: #3498db;
        color: #fff;
        border-top-right-radius: 20px;
        border-bottom-right-radius: 20px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Helvetica, Arial, sans-serif;
    }

    body {
      background-color: #ffffff;
      padding-top: 60px;
      user-select: none;
    }

      

    .container-btn-file {
      display: flex;
      position: relative;
      justify-content: center;
      align-items: center;
      background-color: #307750;
      color: #fff;
      border-style: none;
      padding: 0.85em 0.85em;
      border-radius: 0.5em;
      overflow: hidden;
      z-index: 1;
      transition: all 250ms;
      font-weight: bold;
      min-width: 200px;
      margin-left: 10px;
    }

    .container-btn-file input[type="file"] {
      position: absolute;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }
    .container-btn-file > svg {
      margin-right: 1em;
    }
    .container-btn-file::before {
      content: "";
      position: absolute;
      height: 100%;
      width: 0;
      border-radius: 0.5em;
      background-color: #469b61;
      z-index: -1;
      transition: all 350ms;
    }
    .container-btn-file:hover::before {
      width: 100%;
    }

    .file-name {
      margin-top: 10px;
      font-size: 0.9rem;
      color: #333;
      background: #f0f7ff;
      padding: 5px 10px;
      border-radius: 5px;
      border: 1px dashed #3498db;
      max-width: 300px;
      word-break: break-all;
    }

  

    .timetable-container {
      max-height: 80vh;
      overflow-y: auto;
      overflow-x: hidden;
      border-radius: 12px;
      margin: 5px;
      background: white;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    #timetable {
      width: 100%;
      table-layout: fixed;
      border-collapse: collapse;
      font-size: 13px;
      color: #333;
      margin: 0 auto;
      background-color: #ffffff;
      border: 1px solid #ccc;
      min-width: 100%; /* Forcer le tableau à s'adapter à la largeur du conteneur */
    }

    #timetable thead {
      position: sticky;
      top: 0;
      background-color: #f1f1f1;
      z-index: 100;
      box-shadow: 0 2px 4px -1px rgba(0, 0, 0, 0.1);
      border: 1px solid #ccc;
    }

    #timetable th {
      padding: 10px 8px;
      text-align: center;
      font-weight: bold;
      color: #2c3e50;
      white-space: nowrap;
      border: 1px solid #ccc;
      font-size: 14px;
      white-space: normal;
    }

    #timetable td,
    #timetable th {
      padding: 0;
      word-wrap: break-word;
      border: 1px solid #c5c4c4;
      border-bottom: 1px solid #c5c4c4;
      transition: background-color 0.2s ease;
    }

    #timetable td,
    #timetable th {
      height: 30px;
    }

    #timetable .salle-row td {
  border-bottom: 4px solid #c5c4c4 !important;
}

    .formateur-cell {
      color: #fff;
      font-weight: bold;
      text-align: center;
      vertical-align: middle;
      border-right: 1px solid #4a6491;
      border-bottom: 3px solid #c5c4c4 !important;
      writing-mode: vertical-rl;
      transform: rotate(180deg);
      white-space: nowrap;
      padding: 8px 4px;
      min-width: 120px !important;
      width: 120px !important;
    }

    .type-cell {
      background-color: #f5f5f5;
      font-weight: 300;
      font-size: 12px;
      min-width: 10px;
      max-width: 10px;
      text-align: center;
      width: 10px;
      padding: 4px 6px !important;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .formateur-green {
      background: linear-gradient(to right, #2e55cc, #3927ae);
    }

    .formateur-orange {
      background: linear-gradient(to right, #309654, #1a8139);
    }

    .formateur-red {
      background: linear-gradient(to right, #e74c3c, #c0392b);
    }

    .formateur-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      text-align: center;
    }

    .formateur-name {
      font-weight: bold;
      margin-bottom: 5px;
      text-align: center;
    }

    .formateur-hours {
      font-size: 0.85em;
      font-weight: normal;
      margin-top: 5px;
      background-color: rgba(255, 255, 255, 0.2);
      padding: 2px 5px;
      border-radius: 10px;
      writing-mode: horizontal-tb;
      transform: rotate(180deg);
    }

    .formateur-hours-autogen {
      font-size: 0.85em;
      font-weight: normal;
      margin-top: 5px;
      background-color: rgba(255, 255, 255, 0.2);
      padding: 2px 5px;
      border-radius: 10px;
      writing-mode: horizontal-tb;
      transform: rotate(0deg);
    }
    
    #timetable tbody tr:hover td {
      background-color: #f9f9f9;
    }

    .day-header {
      font-size: 20px !important;
      color: #ffffff;
    }
    
    .day-header {
      font-size: 20px !important;
      color: #ffffff !important;
    }

    .day-header *,
    .day-header::before,
    .day-header::after {
      color: #ffffff !important;
    }

    .time-header {
      color: #ffffff !important; 
      font-weight: bold;
    }

    .weekend-row td {
      background-color: #fafafa;
    }
    
    select {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
    }

    .auto-resize-cell {
      width: 100%;
      padding: 0;
      height: 40px;
    }

    .auto-resize-select {
      width: 100%;
      font-size: 10px;
      border: none;
      outline: none;
      background: transparent;
      white-space: normal;
      overflow: visible;
      text-overflow: initial;
      height: 100%;
      line-height: 1.2;
      text-align: center;
      padding: 2px 4px;
      box-sizing: border-box;
      cursor: pointer;
    }

    .auto-resize-select option {
      text-align: center;
    }

    select::-ms-expand {
      display: none;
    }

    .save-section {
      text-align: center;
      padding: 20px;
      background-color: #f8f9fa;
      border-top: 1px solid #e0e0e0;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }

    .btn {
      padding: 9px 22px;
      font-size: 1.1rem;
      font-weight: 600;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
      margin: 0 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    /* .btn-save a été supprimé */

    .btn-reset {
      background: linear-gradient(to right, #e74c3c, #c0392b);
      color: white;
    }

    .btn-history {
      background: linear-gradient(to right, #9b59b6, #8e44ad);
      color: white;
    }
    
    .btn-export {
      background: linear-gradient(to right, #3498db, #2980b9);
      color: white;
    }

    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
    }

    .btn:active {
      transform: translateY(-1px);
    }
    
    .conflict-highlight {
      background-color: #ffcdd2 !important;
      transition: background-color 0.3s;
    }

    .weekend-row {
      background-color: #f9f9f9;
    }

    .history-section {
      padding: 20px;
      background-color: #f8f9fa;
      border-top: 1px solid #e0e0e0;
    }

    .history-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .history-title {
      font-size: 1.4rem;
      color: #2c3e50;
    }

    .history-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      max-height: 200px;
      overflow-y: auto;
      padding: 10px;
      background-color: white;
      border-radius: 8px;
      box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .week-card {
      background: linear-gradient(to right, #3498db, #2980b9);
      color: white;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      min-width: 120px;
      text-align: center;
    }

    .week-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .week-card.active {
      background: linear-gradient(to right, #27ae60, #2ecc71);
      box-shadow: 0 0 0 3px rgba(39, 174, 96, 0.3);
    }

    .week-card .week-label {
      font-weight: bold;
      font-size: 1.1rem;
    }

    .week-card .dates {
      font-size: 0.85rem;
      opacity: 0.9;
    }
    
    .legend {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 15px;
      flex-wrap: wrap;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 5px;
      background: #f0f7ff;
      padding: 6px 12px;
      border-radius: 20px;
    }
    
    .legend-color {
      width: 20px;
      height: 20px;
      border-radius: 4px;
    }
    
    .legend-green {
      background: linear-gradient(to right, #2ecc71, #27ae60);
    }
    
    .legend-orange {
      background: linear-gradient(to right, #f39c12, #e67e22);
    }
    
    .legend-red {
      background: linear-gradient(to right, #e74c3c, #c0392b);
    }
    
    nav {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 60px;
      padding: 10px 20px;
      background:#fff;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      z-index: 700;
      justify-content: space-between;
    }


    
    .lundi-day-header { background: #007bff; }
    .mardi-day-header { background: #ae06cc; }
    .mercredi-day-header { background: #e74c3c; }
    .jeudi-day-header { background: #f39c12; }
    .vendredi-day-header { background: #27ae60; }
    .samedi-day-header { background: #ff00d9; }
    
    .lundi-session { background: #007bff; }
    .mardi-session { background: #ae06cc; }
    .mercredi-session { background: #e74c3c; }
    .jeudi-session { background: #f39c12; }
    .vendredi-session { background: #27ae60; }
    .samedi-session { background: #ff00d9; }
    
    .lundi-cell { background-color: #E0F0FF !important; }
    .mardi-cell { background-color: #f6d4ff !important; }
    .mercredi-cell { background-color: #ffe0e0 !important; }
    .jeudi-cell { background-color: #fff7e0 !important; }
    .vendredi-cell { background-color: #e0ffe0 !important; }
    .samedi-cell { background-color: #ffe0fd !important; }

    .selected-cell {
      background-color: #000000 !important;
      font-weight: bold !important;
      color: #ffffff !important;
    }

    .selected-cell * {
      color: #ffffff !important;
      font-weight: bold !important;
    }

    .selected-cell input,
    .selected-cell select {
      color: #ffffff !important;
      font-weight: bold !important;
      background-color: #000000 !important;
      border-color: #ffffff !important;
    }

    .draggable-cell {
      cursor: move;
      transition: all 0.3s ease;
      position: relative;
    }
    
    .dragging {
      opacity: 0.5;
      transform: scale(0.95);
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
      z-index: 1000;
    }
    
    .drag-over {
      background-color: #e3f2fd !important;
      border: 2px dashed #2196F3 !important;
    }
    
    .drop-target {
      background-color: #e3f2fd !important;
      border: 2px dashed #2196F3 !important;
    }
    
    .drop-hint {
      position: absolute;
      background: #2196F3;
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 12px;
      pointer-events: none;
      z-index: 1000;
      opacity: 0.9;
      transform: translateY(-100%);
    }
    
    .drag-indicator {
      position: absolute;
      top: 2px;
      right: -5px;
      font-size: 10px;
      opacity: 0;
      cursor: move;
      width: 20px;
      height: 20px;
      z-index: 10;
    }

    .draggable-cell:hover .drag-indicator {
      opacity: 0.5;
    }
    
    .group-highlight {
      animation: pulse 2s infinite;
      border: 2px solid #ff9800;
      box-shadow: 0 0 10px rgba(255, 152, 0, 0.5);
    }
    
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(255, 152, 0, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(255, 152, 0, 0); }
      100% { box-shadow: 0 0 0 0 rgba(255, 152, 0, 0); }
    }
    
    .excel-selection {
      position: absolute;
      border: 2px solid #2196F3;
      background-color: rgba(33, 150, 243, 0.1);
      pointer-events: none;
      z-index: 500;
    }
    
    .excel-selected {
      background-color: rgba(33, 150, 243, 0.3) !important;
      outline: 2px solid #2196F3 !important;
      position: relative;
      z-index: 50;
    }
    
    .excel-selected.select-focus {
      background-color: rgba(33, 150, 243, 0.4) !important;
    }
    
    .excel-toolbar {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      background: white;
      padding: 10px 20px;
      border-radius: 50px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      z-index: 600;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
    }
    
    .excel-toolbar.visible {
      opacity: 1;
      pointer-events: auto;
    }
    
    .excel-toolbar button {
      background: #f5f5f5;
      border: none;
      border-radius: 5px;
      padding: 8px 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: background 0.2s;
    }
    
    .excel-toolbar button:hover {
      background: #e0e0e0;
    }
    
    .keyboard-shortcut {
      background: #e0e0e0;
      border-radius: 3px;
      padding: 2px 4px;
      font-size: 0.8em;
      margin-left: 5px;
    }
    
    .tooltip {
      position: relative;
      display: inline-block;
    }
    
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 120px;
      background-color: #555;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
    
    .paste-notification {
      position: fixed;
      bottom: 70px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 8px 15px;
      border-radius: 20px;
      z-index: 700;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .paste-notification.show {
      opacity: 1;
    }

    .conflict-highlight {
      background-color: #ffdddd !important;
    }

    td[data-salle="TEAMS"] .conflict-highlight {
      background-color: transparent !important;
    }
    
    /* Styles pour les espaces personnalisés */
    .espace-section {
      margin: 15px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .espace-controls {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .espace-controls input {
      flex: 1;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    
    .espace-controls button {
      padding: 10px 15px;
      background: #3498db;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    
    .espace-controls button:hover {
      background: #2980b9;
    }
    
    .espaces-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .espace-tag {
      background: #3498db;
      color: white;
      padding: 5px 10px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .espace-tag button {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      font-weight: bold;
    }
    
    /* Section d'export */
    .export-section {
      display: flex;
      justify-content: center;
      margin-top: 15px;
      gap: 10px;
    }

    .save-status {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 15px 25px;
      color: white;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      z-index: 1000;
      transform: translateX(150%);
      transition: transform 0.3s ease;
      background-color: #3498db;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .save-status.show {
      transform: translateX(0);
    }
    
    .save-status.error {
      background-color: #e74c3c;
    }
    
    .save-status.success {
      background-color: #2ecc71;
    }

    
    /* ======================================================= */
/* ==      NOUVEAU STYLE POUR LE LOADER ANIMÉ           == */
/* ======================================================= */

/* Ce conteneur gère l'arrière-plan et le centrage */
.loader-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(44, 62, 80, 0.235); /* Un fond sombre pour mieux voir l'animation */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

/* Le texte sous l'animation */
.loader-container p {
    color: white;
    font-weight: 500;
    margin-top: 20px;
    letter-spacing: 1px;
}

/* Votre code CSS pour l'animation (inchangé) */
.loader {
  position: relative;
  width: 33px;
  height: 33px;
  perspective: 67px;
}

.loader div {
  width: 100%;
  height: 100%;
  background: #fff;
  position: absolute;
  left: 50%;
  transform-origin: left;
  animation: loader 2s infinite;
}

.loader div:nth-child(1) {
  animation-delay: 0.15s;
}

.loader div:nth-child(2) {
  animation-delay: 0.3s;
}

.loader div:nth-child(3) {
  animation-delay: 0.45s;
}

.loader div:nth-child(4) {
  animation-delay: 0.6s;
}

.loader div:nth-child(5) {
  animation-delay: 0.75s;
}

@keyframes loader {
  0% {
    transform: rotateY(0deg);
  }

  50%, 80% {
    transform: rotateY(-180deg);
  }

  90%, 100% {
    opacity: 0;
    transform: rotateY(-180deg);
  }
}

    nav a {
      text-decoration: none;
      color: #333;
      padding: 8px 16px;
      border-radius: 8px;
      transition: background-color 0.3s, color 0.3s;
    }

    nav a:hover {
      background-color: #f0f4ff;
      color: #1d4ed8; /* Bleu foncé */
      font-weight: 600;
    }

    nav a.active {
      background-color: #f0f4ff;
      color: #1d4ed8; /* Bleu foncé */
      font-weight: 600;
    }

    /* AJOUTEZ CE BLOC CSS DANS VOS PAGES */

.nav-links {
    display: flex;
    align-items: center;
    gap: 10px; /* Espace entre les liens et le bouton de profil */
}

/* Conteneur principal pour le menu de profil */
/* AJOUTEZ/REMPLACEZ CE BLOC CSS DANS VOS PAGES */

.profile-menu-container {
    position: relative;
}

.profile-button {
    display: flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: #e0eaff; /* Couleur similaire à un lien actif */
    color: #1d4ed8;
    border: 1px solid #e0eaff;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
}


.profile-dropdown {
    display: none;
    position: absolute;
    top: calc(100% + 12px);
    right: 0;
    width: 280px;
    background-color: white;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    z-index: 1010;
    overflow: hidden;
    transform-origin: top right;
    animation: scale-up-and-fade-in 0.2s ease-out;
}

.profile-dropdown.show {
    display: block; /* La classe .show le rend visible */
}

@keyframes scale-up-and-fade-in {
    from {
        transform: scale(0.95);
        opacity: 0;
    }
    to {
        transform: scale(1);
        opacity: 1;
    }
}


.dropdown-profile-header {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px;
    border-bottom: 1px solid #f3f4f6;
}

.profile-pic {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background-color: #f3f4f6;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    color: #6b7280;
}

.profile-info strong {
    display: block;
    font-size: 1rem;
    font-weight: 600;
    color: #111827;
}
.profile-info small {
    font-size: 0.875rem;
    color: #6b7280;
}

.dropdown-menu-list {
    list-style: none;
    padding: 8px;
    margin: 0;
}

.dropdown-link {
    display: flex;
    align-items: center;
    width: 100%;
    padding: 10px 12px;
    border-radius: 8px;
    text-decoration: none;
    color: #374151;
    font-weight: 500;
    transition: background-color 0.2s, color 0.2s;
}
.dropdown-link:hover {
    background-color: #f3f4f6;
}

.dropdown-link .icon {
    width: 32px;
    font-size: 16px;
    color: #6b7280;
}
.dropdown-link .text {
    flex-grow: 1;
}
.dropdown-link .chevron {
    font-size: 12px;
    color: #9ca3af;
}

.dropdown-divider {
    margin: 0 8px;
    border: none;
    border-top: 1px solid #f3f4f6;
}

.dropdown-link.logout {
    margin: 8px;
    width: calc(100% - 16px);
    color: #ef4444; /* Rouge */
}
.dropdown-link.logout .icon {
    color: #ef4444;
}
.dropdown-link.logout:hover {
    background-color: #fee2e2;
}

    /* Styles pour le tableau des contraintes dans la modale */
    .constraints-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }
    .constraints-table th, .constraints-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
      vertical-align: middle;
    }
    .constraints-table th {
      background-color: #f2f2f2;
      font-weight: 600;
    }
    .constraints-table .formateur-name-col {
      font-weight: bold;
      min-width: 150px;
    }
    .constraints-table input[type="number"] {
      width: 60px;
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .constraints-table select[multiple] {
      width: 100%;
      min-height: 80px;
    }

    .availability-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 5px;
    }
    .availability-grid label {
      font-size: 12px;
      display: flex;
      align-items: center;
    }
    .availability-grid input {
      margin-right: 4px;
    }


 /* NOUVEAUX STYLES SANS ASCENSEUR */
.spaces-checkbox-container {
  /* On a retiré max-height et overflow-y */
  border: 1px solid #ddd;
  padding: 8px;
  border-radius: 4px;
  background-color: #f9f9f9; /* Légère couleur de fond pour distinguer la zone */
}
.spaces-checkbox-container label {
  display: block; 
  padding: 3px 0;
  user-select: none;
  cursor: pointer;
}
.spaces-checkbox-container input {
  margin-right: 8px;
  vertical-align: middle;
}


/* ... (votre autre CSS) ... */

/* NOUVEAUX STYLES POUR LE BOUTON UIVERSE */

#voiceAssistantBtn {
  position: fixed;
  bottom: 30px;
  right: 30px;
  z-index: 1100;
}

.uiverse {
  --duration: 7s;
  --easing: linear;
  --c-color-1: rgba(255, 163, 26, 0.7);
  --c-color-2: #1a23ff;
  --c-color-3: #e21bda;
  --c-color-4: rgba(255, 232, 26, 0.7);
  --c-shadow: rgba(255, 223, 87, 0.5);
  --c-shadow-inset-top: rgba(255, 223, 52, 0.9);
  --c-shadow-inset-bottom: rgba(255, 250, 215, 0.8);
  --c-radial-inner: #ffd215;
  --c-radial-outer: #fff172;
  --c-color: #ffffff;
  -webkit-tap-highlight-color: transparent;
  -webkit-appearance: none;
  outline: none;
  position: relative;
  cursor: pointer;
  border: none;
  
  /* --- MODIFICATIONS CLÉS POUR LA FORME CIRCULAIRE --- */
  width: 60px; /* AJOUTÉ: Largeur fixe */
  height: 60px; /* AJOUTÉ: Hauteur fixe */
  border-radius: 50%; /* MODIFIÉ: Pour un cercle parfait */
  padding: 0; /* MODIFIÉ: Pas de padding sur le bouton lui-même */
  /* --- FIN DES MODIFICATIONS CLÉS --- */

  margin: 0;
  text-align: center;
  font-weight: 600;
  letter-spacing: 0.02em;
  line-height: 1.5;
  color: var(--c-color);
  background: radial-gradient(
    circle,
    var(--c-radial-inner),
    var(--c-radial-outer) 80%
  );
  box-shadow: 0 0 14px var(--c-shadow);
}

.uiverse:before {
  content: "";
  pointer-events: none;
  position: absolute;
  z-index: 3;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  border-radius: 50%; /* MODIFIÉ: Doit correspondre au bouton */
  box-shadow:
    inset 0 3px 12px var(--c-shadow-inset-top),
    inset 0 -3px 4px var(--c-shadow-inset-bottom);
}

.uiverse .wrapper {
  -webkit-mask-image: -webkit-radial-gradient(white, black);
  overflow: hidden;
  border-radius: 50%; /* MODIFIÉ: Doit correspondre au bouton */
  
  /* --- AJOUTS POUR CENTRER LE CONTENU --- */
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  /* --- FIN DES AJOUTS --- */
}

.uiverse .wrapper span {
  display: inline-block;
  position: relative;
  z-index: 1;
  font-size: 24px; /* AJOUTÉ: Pour une icône plus grande */
  line-height: 0; /* AJOUTÉ: Pour un centrage vertical parfait */
}

.uiverse:hover {
  --duration: 1400ms;
}

.uiverse.listening {
    --duration: 1s;
    box-shadow: 0 0 25px var(--c-color-2), 0 0 15px var(--c-shadow);
}
.uiverse.listening span i {
    animation: pulse-mic 1.5s infinite;
}

@keyframes pulse-mic {
    0% { transform: scale(1); color: #e74c3c; }
    50% { transform: scale(1.3); color: #1a23ff; }
    100% { transform: scale(1); color: #e74c3c; }
}

.uiverse .wrapper .circle {
  position: absolute;
  left: 0;
  top: 0;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  filter: blur(var(--blur, 8px));
  background: var(--background, transparent);
  transform: translate(var(--x, 0), var(--y, 0)) translateZ(0);
  animation: var(--animation, none) var(--duration) var(--easing) infinite;
}

/* ... (toutes les classes .circle et les @keyframes restent les mêmes) ... */
.uiverse .wrapper .circle.circle-1,
.uiverse .wrapper .circle.circle-9,
.uiverse .wrapper .circle.circle-10 {
  --background: var(--c-color-4);
}
.uiverse .wrapper .circle.circle-3,
.uiverse .wrapper .circle.circle-4 {
  --background: var(--c-color-2);
  --blur: 14px;
}
.uiverse .wrapper .circle.circle-5,
.uiverse .wrapper .circle.circle-6 {
  --background: var(--c-color-3);
  --blur: 16px;
}
.uiverse .wrapper .circle.circle-2,
.uiverse .wrapper .circle.circle-7,
.uiverse .wrapper .circle.circle-8,
.uiverse .wrapper .circle.circle-11,
.uiverse .wrapper .circle.circle-12 {
  --background: var(--c-color-1);
  --blur: 12px;
}
.uiverse .wrapper .circle.circle-1 { --x: 0; --y: -40px; --animation: circle-1; }
.uiverse .wrapper .circle.circle-2 { --x: 92px; --y: 8px; --animation: circle-2; }
.uiverse .wrapper .circle.circle-3 { --x: -12px; --y: -12px; --animation: circle-3; }
.uiverse .wrapper .circle.circle-4 { --x: 80px; --y: -12px; --animation: circle-4; }
.uiverse .wrapper .circle.circle-5 { --x: 12px; --y: -4px; --animation: circle-5; }
.uiverse .wrapper .circle.circle-6 { --x: 56px; --y: 16px; --animation: circle-6; }
.uiverse .wrapper .circle.circle-7 { --x: 8px; --y: 28px; --animation: circle-7; }
.uiverse .wrapper .circle.circle-8 { --x: 28px; --y: -4px; --animation: circle-8; }
.uiverse .wrapper .circle.circle-9 { --x: 20px; --y: -12px; --animation: circle-9; }
.uiverse .wrapper .circle.circle-10 { --x: 64px; --y: 16px; --animation: circle-10; }
.uiverse .wrapper .circle.circle-11 { --x: 4px; --y: 4px; --animation: circle-11; }
.uiverse .wrapper .circle.circle-12 { --blur: 14px; --x: 52px; --y: 4px; --animation: circle-12; }

@keyframes circle-1 { 33% { transform: translate(0px, 16px) translateZ(0); } 66% { transform: translate(12px, 64px) translateZ(0); } }
@keyframes circle-2 { 33% { transform: translate(80px, -10px) translateZ(0); } 66% { transform: translate(72px, -48px) translateZ(0); } }
@keyframes circle-3 { 33% { transform: translate(20px, 12px) translateZ(0); } 66% { transform: translate(12px, 4px) translateZ(0); } }
@keyframes circle-4 { 33% { transform: translate(76px, -12px) translateZ(0); } 66% { transform: translate(112px, -8px) translateZ(0); } }
@keyframes circle-5 { 33% { transform: translate(84px, 28px) translateZ(0); } 66% { transform: translate(40px, -32px) translateZ(0); } }
@keyframes circle-6 { 33% { transform: translate(28px, -16px) translateZ(0); } 66% { transform: translate(76px, -56px) translateZ(0); } }
@keyframes circle-7 { 33% { transform: translate(8px, 28px) translateZ(0); } 66% { transform: translate(20px, -60px) translateZ(0); } }
@keyframes circle-8 { 33% { transform: translate(32px, -4px) translateZ(0); } 66% { transform: translate(56px, -20px) translateZ(0); } }
@keyframes circle-9 { 33% { transform: translate(20px, -12px) translateZ(0); } 66% { transform: translate(80px, -8px) translateZ(0); } }
@keyframes circle-10 { 33% { transform: translate(68px, 20px) translateZ(0); } 66% { transform: translate(100px, 28px) translateZ(0); } }
@keyframes circle-11 { 33% { transform: translate(4px, 4px) translateZ(0); } 66% { transform: translate(68px, 20px) translateZ(0); } }
@keyframes circle-12 { 33% { transform: translate(56px, 0px) translateZ(0); } 66% { transform: translate(60px, -32px) translateZ(0); } }

    .assistant-status {
        position: fixed;
        bottom: 100px;
        right: 30px;
        background: rgba(0, 0, 0, 0.75);
        color: white;
        padding: 10px 20px;
        border-radius: 20px;
        z-index: 1099;
        opacity: 0;
        transition: opacity 0.3s ease;
        pointer-events: none; /* Pour ne pas gêner les clics */
    }
    .assistant-status.visible {
        opacity: 1;
    }


    /* ======================================================= */
    /* ==      NOUVEAUX STYLES POUR LA NOTIFICATION         == */
    /* ======================================================= */
    :root {
      --notification-inset: 2rem;
      --animation-play-state: running;
    }

    .notification {
      color: rgba(0, 0, 0, 0.7);
      position: fixed;
      display: flex;
      font-size: 1.1rem; /* Taille de police ajustée */
      letter-spacing: 1px; /* Espacement ajusté */
      line-height: 1.4;
      gap: 1.25rem; /* Espace ajusté */
      top: 0;
      right: 0;
      margin: var(--notification-inset);
      width: 22rem; /* Largeur ajustée */
      background-color: white;
      box-shadow: 0 0 0.5rem rgba(0, 0, 0, 0.25);
      border-radius: 0.5rem;
      max-width: calc(100% - 4rem); /* Marge ajustée */
      z-index: 9999;
      padding: 1.25rem 1rem; /* Remplissage ajusté */
      overflow: hidden; /* changé de clip à hidden pour meilleure compatibilité */
      transform: translateX(calc(100% + var(--notification-inset)));
      animation: slideInOut 160s cubic-bezier(0.33, 0, 0.66, 1.33);
      animation-fill-mode: forwards; /* Pour que l'état final persiste */
    }

    .notification.show {
        transform: translateX(0);
        animation: slideIn 0.5s cubic-bezier(0.33, 0, 0.66, 1.33) forwards;
    }
    
    .notification.hide {
        animation: slideOut 0.5s cubic-bezier(0.33, 0, 0.66, 1.33) forwards;
    }

    .notification:before {
      content: "";
      display: block;
      position: absolute;
      inset: 0 auto auto 0;
      height: 0.35rem; /* Hauteur ajustée */
      background-color: var(--accent-color, #49a87d);
      transform-origin: left;
      animation: countdown 3.5s linear forwards;
      animation-delay: 0.5s;
    }

    .notification__text {
      margin: 0.2rem 0 0;
      font-size: 0.9rem;
    }

    .notification__header {
      color: black;
      margin: 0;
      font-size: 1.2rem; /* Taille ajustée */
      font-weight: 600;
    }

    .notification__action {
      margin-left: auto;
    }
    
    .notification__action .button {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.2s;
    }
    
    .notification__action .button:hover {
        background-color: rgba(0,0,0,0.1);
    }

    .notification__icon {
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 3rem; /* Taille ajustée */
      height: 3rem; /* Taille ajustée */
      background-color: var(--accent-color, #49a87d);
      flex-shrink: 0;
    }
    
    .notification__icon i {
        font-size: 1.5rem;
        color: white;
    }

    .button {
      appearance: none;
      background: none;
      border: none;
      font: inherit;
      margin: 0;
      color: currentColor;
      padding: 0;
      cursor: pointer;
    }

    @keyframes slideIn {
        from { transform: translateX(calc(100% + var(--notification-inset))); }
        to { transform: translateX(0); }
    }
    
    @keyframes slideOut {
        from { transform: translateX(0); }
        to { transform: translateX(calc(100% + var(--notification-inset))); }
    }

    @keyframes countdown {
      to {
        transform: scaleX(0);
      }
    }
    
    /* ======================================================= */
    /* ==      NOUVEAUX STYLES POUR LE BOUTON ENREGISTRER   == */
    /* ======================================================= */
    .button {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 8px 12px 8px 16px;
      gap: 8px;
      height: 45px;
      width: 150px;
      border: none;
      background: #e6f0ff;
      border-radius: 20px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .button-reset {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 8px 12px 8px 16px;
      gap: 8px;
      height: 45px;
      width: 150px;
      border: none;
      background: #ff362b34;
      border-radius: 20px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .button-autogen {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 8px 12px 8px 16px;
      gap: 4px;
      height: 45px;
      width: 270px;
      border: none;
      background: #5e41de33;
      border-radius: 20px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .button:hover {
      background: #d2e3fd;
    }

    .button-reset:hover {
      background: #ff362b52;
    }

    .button-autogen:hover {
      background: #5e41de4d;
    }

    .svg-icon {
      width: 20px;
      height: 20px;
      stroke: #056dfa;
    }

    .svg-icon-autogen {
      width: 20px;
      height: 20px;
      stroke: #5d41de;
    }

    .lable {
      margin-top: 1px;
      font-weight: 600;
      font-size: 15px;
      line-height: 22px;
      color: #056dfa;
      letter-spacing: 1px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Helvetica, Arial, sans-serif;
    }

    .lable-reset {
      margin-top: 1px;
      font-weight: 600;
      font-size: 15px;
      line-height: 22px;
      color: #fa0505;
      letter-spacing: 1px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Helvetica, Arial, sans-serif;
    }

    .lable-autogen {
      margin-top: 1px;
      font-weight: 600;
      font-size: 15px;
      line-height: 22px;
      color: #5D41DE;
      letter-spacing: 1px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Helvetica, Arial, sans-serif;
    }




    .button#notificationClose{
      background-color: white;
    }

    .upload-section{
      margin-top: 35px;
    }



    .drop-possible {
      background-color: #e8f5e9 !important;
      border: 2px dashed #4CAF50 !important;
  outline-offset: -1px;
}
    

/* ================================================================= */
/*          NOUVEAU CODE CORRIGÉ POUR LES BADGES ET L'ÉTOILE         */
/* ================================================================= */

/* --- Base commune pour les cellules de module --- */
.auto-resize-cell.module-s1,
.auto-resize-cell.module-s2,
.auto-resize-cell.module-annual,
.auto-resize-cell.module-regional {
    position: relative;
    overflow: visible;
}


/* --- Badge Numérique (Carré + Chiffre) via ::after --- */
/* Reste inchangé, en haut à droite */
.auto-resize-cell.module-s1::after,
.auto-resize-cell.module-s2::after,
.auto-resize-cell.module-annual::after {
    /* Propriétés du texte (Numéro/Lettre) */
    color: white;
    font-size: 10px;
    font-weight: 700;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    text-shadow: 0 0.5px 1px rgba(0,0,0,0.3);

    /* Propriétés de la boîte (Carré) */
    position: absolute;
    top: 4px;
    right: 4px; /* Aligné à droite */
    width: 14px;
    height: 14px;
    border-radius: 3px;
    box-shadow:
        0 0 0 1px rgba(255,255,255,0.8) inset,
        0 1px 2px rgba(0,0,0,0.1);

    /* Centrage du texte dans la boîte */
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2;
    pointer-events: none;
}

/* Contenu et couleur spécifiques à chaque type de badge */
.auto-resize-cell.module-s1::after {
    content: "1";
    background-color: #1B9AF0;
}

.auto-resize-cell.module-s2::after {
    content: "2";
    background-color: #2BB673;
}

.auto-resize-cell.module-annual::after {
    content: "A";
    background-color: #FF6D00;
}


/* --- Étoile pour les modules Régionaux via ::before --- */
/*
 * MODIFICATION : L'étoile est maintenant positionnée à gauche
 * pour une meilleure visibilité.
*/
.auto-resize-cell.module-regional::before {
  content: "⭐";
  position: absolute;
  top: calc(100% - 28px);
  left: 3px; /* CHANGEMENT ICI : de 'right' à 'left' */
  font-size: 8px;
  color: gold;
  text-shadow: 0 0 1px rgba(0, 0, 0, 0.5);
  z-index: 1;
  pointer-events: none;
}


/* --- Styles inchangés pour les listes déroulantes --- */
.auto-resize-cell.module-s1 select,
.auto-resize-cell.module-s2 select,
.auto-resize-cell.module-annual select {
    padding-top: 5px;
    padding-right: 20px;
    padding-left: 6px;
    cursor: pointer;
    background-color: rgba(0,0,0,0.03);
    border-radius: 3px;
    font-size: 0.9em;
}
/* --- FIN Styles pour les modules Régionaux --- */

@media (max-height: 600px) {
  #autoGenModal > div {
    max-height: 95vh;
  }
}

/* ======================================================= */
/* ==  NOUVEAUX STYLES POUR LA MODALE DE RÉSUMÉ (GROUPES) == */
/* ======================================================= */
.summary-modal {
  display: none;
  position: fixed;
  z-index: 2000; /* Doit être au-dessus du loader */
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.6);
  animation: fadeIn 0.3s ease;
}

/* ... juste après les styles de .summary-modal ... */

.chart-container {
  position: relative;
  height: 400px; /* Hauteur maximale du graphique */
  width: 100%;
  margin-bottom: 25px; /* Espace entre le graphique et le tableau */
}

.summary-modal-content {
  background-color: #fefefe;
  margin: 10% auto;
  padding: 25px;
  border: 1px solid #888;
  width: 90%;
  max-width: 2000px;
  border-radius: 12px;
  box-shadow: 0 5px 20px rgba(0,0,0,0.25);
  transform: scale(0.95);
  animation: scaleUp 0.3s ease-out forwards;
}

.summary-modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid #eee;
  padding-bottom: 15px;
  margin-bottom: 15px;
}

.summary-modal-header h2 {
  margin: 0;
  font-size: 1.5rem;
  color: #2c3e50;
}

.summary-modal-body p {
    font-size: 1.05rem;
    color: #34495e;
    margin-bottom: 20px;
}

.close-btn {
  color: #aaa;
  font-size: 28px;
  font-weight: bold;
  background: none;
  border: none;
  cursor: pointer;
  padding: 0 10px;
}

.close-btn:hover,
.close-btn:focus {
  color: #e74c3c;
  text-decoration: none;
}

.summary-table-container {
    max-height: 400px;
    overflow-y: auto;
    border-radius: 8px;
    
}

#groupHoursSummaryTable {
    width: 100%;
    border-collapse: collapse;
}

#groupHoursSummaryTable th, #groupHoursSummaryTable td {
    padding: 12px 15px;
    text-align: left;
    border-bottom: 1px solid #e7e7e7;
}

#groupHoursSummaryTable th {
    background-color: #f8f9fa;
    font-weight: 600;
    color: #34495e;
    position: sticky;
    top: 0;
}

#groupHoursSummaryTable td:last-child {
    font-weight: bold;
    text-align: center;
}

#groupHoursSummaryTable tr:nth-child(even) {
    background-color: #fdfdfd;
}

#groupHoursSummaryTable tr:hover {
    background-color: #f1f5f9;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes scaleUp {
  from { transform: scale(0.95); opacity: 0.5; }
  to { transform: scale(1); opacity: 1; }
}

/* ... Ajoutez ceci avec les autres styles de boutons ... */

.button-analyze {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 8px 12px 8px 16px;
  gap: 8px;
  height: 45px;
  width: 150px; /* Ou ajustez selon votre préférence */
  border: none;
  background: #a58eff33; /* Une couleur distincte */
  border-radius: 20px;
  cursor: pointer;
  transition: background 0.3s ease;
}

.button-analyze:hover {
  background: #a58eff4d;
}

.svg-icon-analyze {
  width: 20px;
  height: 20px;
  stroke: #6a44ff; /* Couleur de l'icône */
}

.lable-analyze {
  margin-top: 1px;
  font-weight: 600;
  font-size: 15px;
  line-height: 22px;
  color: #6a44ff; /* Couleur du texte */
  letter-spacing: 1px;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Helvetica, Arial, sans-serif;
}


.custom-select-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
}

/* Le span qui affiche la valeur sélectionnée (AVEC ESPACE POUR LE BADGE) */
/* Le span qui affiche la valeur sélectionnée (AVEC RETOUR À LA LIGNE) */
.custom-select-display {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;

    /* -- Modifications pour le retour à la ligne -- */
    display: flex;         /* On garde flexbox pour le centrage vertical */
    align-items: center;   /* Centre le contenu verticalement */
    justify-content: center; /* Centre le contenu horizontalement */
    flex-wrap: wrap;       /* <<< TRÈS IMPORTANT : autorise le retour à la ligne */
    
    text-align: center;    /* Assure que le texte multi-ligne reste centré */
    white-space: normal;   /* Permet au texte de se couper et de passer à la ligne */
    word-break: break-word; /* Force la césure des mots longs pour éviter le débordement */
    overflow: visible;     /* <<< TRÈS IMPORTANT : rend le contenu qui dépasse visible */

    /* -- Styles conservés et ajustés -- */
    padding: 2px 22px 2px 6px; /* Espace pour le texte (à gauche) et le badge (à droite) */
    font-size: 11px;       /* Taille de police légèrement réduite pour mieux s'adapter */
    font-weight: 500;
    line-height: 1.2;      /* Espace entre les lignes pour la lisibilité */
    
    pointer-events: none; 
    color: #333;
}

/* Le vrai select est rendu transparent mais reste 100% fonctionnel */
.custom-select-wrapper .auto-resize-select {
    opacity: 0;
    position: relative; /* Pour s'assurer qu'il est bien dans le flux */
    z-index: 1; /* Il est techniquement "au-dessus" mais invisible */
}

  </style>
</head>

<body>
  <div class="container">
    <nav>
      <img src="assets/images/logo_edtpro.png" style="height: 80px; width: auto;" id="logo" alt="Logo">
      <div class="nav-links"> <!-- J'ai ajouté une classe pour mieux cibler les liens -->
          <a href="emploi.html" id="nav-emploi">Emploi globale</a>
          <a href="edition.html" id="nav-edition">Edition</a>
          <a href="avancement.html" id="nav-avancement">Avancement</a>
          <div class="profile-menu-container" id="profile-menu-container">
            <!-- Le bouton/lien principal reste le même -->
            <button id="profile-button" class="profile-button">
              <span id="profile-initials">--</span>
          </button>
        
            <!-- === NOUVELLE STRUCTURE SIMPLIFIÉE DU MENU DÉROULANT === -->
<div id="profile-dropdown" class="profile-dropdown">
  <!-- En-tête avec l'image et le nom -->
  <div class="dropdown-profile-header">
      <div class="profile-pic">
          <i class="fas fa-user"></i>
      </div>
      <div class="profile-info">
          <strong id="dropdown-user-name">Chargement...</strong>
          <small id="dropdown-user-email">...</small>
      </div>
  </div>

  <!-- Liste des liens (simplifiée) -->
  <ul class="dropdown-menu-list">
      <li>
          <a href="profile.html" class="dropdown-link">
              <i class="fas fa-user-edit icon"></i>
              <span class="text">Mon Profil</span>
              <i class="fas fa-chevron-right chevron"></i>
          </a>
      </li>
      <!-- Le lien "Paramètres" a été supprimé -->
  </ul>

  <!-- Séparateur et lien de déconnexion -->
  <hr class="dropdown-divider">
  <a href="../api/auth/logout.php" class="dropdown-link logout">
      <i class="fas fa-sign-out-alt icon"></i>
      <span class="text">Déconnexion</span>
  </a>
</div>
<!-- ======================================================== -->
      </div>
  </nav>
    
    <section class="upload-section">
      <div class="upload">
        <div class="file-input-container">
          <button class="container-btn-file">
            <svg fill="#fff" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 50 50">
              <path d="M28.8125 .03125L.8125 5.34375C.339844 5.433594 0 5.863281 0 6.34375L0 43.65625C0 
                44.136719 .339844 44.566406 .8125 44.65625L28.8125 
                49.96875C28.875 49.980469 28.9375 50 29 50C29.230469 
                50 29.445313 49.929688 29.625 49.78125C29.855469 49.589844 
                30 49.296875 30 49L30 1C30 .703125 29.855469 .410156 29.625 
                .21875C29.394531 .0273438 29.105469 -.0234375 28.8125 .03125ZM32 
                6L32 13L34 13L34 15L32 15L32 20L34 20L34 22L32 22L32 27L34 27L34 
                29L32 29L32 35L34 35L34 37L32 37L32 44L47 44C48.101563 44 49 
                43.101563 49 42L49 8C49 6.898438 48.101563 6 47 6ZM36 13L44 
                13L44 15L36 15ZM6.6875 15.6875L11.8125 15.6875L14.5 21.28125C14.710938 
                21.722656 14.898438 22.265625 15.0625 22.875L15.09375 22.875C15.199219 
                22.511719 15.402344 21.941406 15.6875 21.21875L18.65625 15.6875L23.34375 
                15.6875L17.75 24.9375L23.5 34.375L18.53125 34.375L15.28125 
                28.28125C15.160156 28.054688 15.035156 27.636719 14.90625 
                27.03125L14.875 27.03125C14.8125 27.316406 14.664063 27.761719 
                14.4375 28.34375L11.1875 34.375L6.1875 34.375L12.15625 25.03125ZM36 
                20L44 20L44 22L36 22ZM36 27L44 27L44 29L36 29ZM36 35L44 35L44 37L36 37Z">
              </path>
            </svg>
            Sélectionner fichier
            <input class="file" name="text" type="file" id="fileInput" accept=".xlsx, .xls" />
          </button>
          <div class="file-name" id="fileName" style="display: none;">Aucun fichier sélectionné</div>
        </div>

        <!-- ***** DÉBUT DE LA ZONE DU CALENDRIER PERSONNALISÉ ***** -->
        <div class="week-selection">
            <div class="custom-week-picker">
              <div id="customWeekDisplay">
                <img src="https://cdn-icons-png.flaticon.com/512/12887/12887924.png" alt="">
                <span id="weekDisplayText"></span>
              </div>
                <div id="calendarPopup">
                    <div class="calendar-header">
                        <button id="prevMonthBtn"><i class="fas fa-chevron-left"></i></button>
                        <span id="calendarTitle"></span>
                        <button id="nextMonthBtn"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    <table class="calendar-grid">
                        <thead>
                            <tr><th>L</th><th>M</th><th>M</th><th>J</th><th>V</th><th>S</th><th>D</th></tr>
                        </thead>
                        <tbody id="calendarBody"></tbody>
                    </table>
                </div>
            </div>

            <div class="week-import-btn">
              <button class="btn-import" id="importWeekBtn">
                <svg class="svg-icon-import" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="#9b59b6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                  <path d="M3 15v4c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2v-4M17 8l-5-5-5 5M12 4.2v10.3"/>
                </svg>
                <span class="lable-import">Importer</span>
              </button>
              <div id="weekImportMenu" class="week-import-menu">
                <!-- Le contenu sera chargé dynamiquement -->
              </div>
            </div>
        </div>
        <!-- ***** FIN DE LA ZONE DU CALENDRIER PERSONNALISÉ ***** -->

        <!-- MODIFICATION : ANCIEN BOUTON REMPLACÉ PAR LE NOUVEAU -->
        <button class="button" id="saveTimetableBtn">
          <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="#056dfa" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
            <path d="M3 6H21V18a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6z"/>
            <path d="M3 6l3-4h6l3 4"/>
          </svg>
          <span class="lable">Enregistrer</span>
        </button>

        <button class="button-reset" id="resetBtn">
          <svg
    xmlns="http://www.w3.org/2000/svg"
    width="20"
    viewBox="0 0 20 20"
    height="20"
    fill="none"
    class="svg-icon-reset"
  >
    <g stroke-width="1.5" stroke-linecap="round" stroke="#ff342b">
      <path
        d="m3.33337 10.8333c0 3.6819 2.98477 6.6667 6.66663 6.6667 3.682 0 6.6667-2.9848 6.6667-6.6667 0-3.68188-2.9847-6.66664-6.6667-6.66664-1.29938 0-2.51191.37174-3.5371 1.01468"
      ></path>
      <path
        d="m7.69867 1.58163-1.44987 3.28435c-.18587.42104.00478.91303.42582 1.0989l3.28438 1.44986"
      ></path>
    </g>
  </svg>
          <span class="lable-reset">Réinitialiser</span>
        </button>

        <button class="button-autogen" id="autoGenerateBtn">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 20 20" height="20" fill="none" class="svg-icon"><g stroke-width="1.5" stroke-linecap="round" stroke="#5d41de"><circle r="2.5" cy="10" cx="10"></circle><path fill-rule="evenodd" d="m8.39079 2.80235c.53842-1.51424 2.67991-1.51424 3.21831-.00001.3392.95358 1.4284 1.40477 2.3425.97027 1.4514-.68995 2.9657.82427 2.2758 2.27575-.4345.91407.0166 2.00334.9702 2.34248 1.5143.53842 1.5143 2.67996 0 3.21836-.9536.3391-1.4047 1.4284-.9702 2.3425.6899 1.4514-.8244 2.9656-2.2758 2.2757-.9141-.4345-2.0033.0167-2.3425.9703-.5384 1.5142-2.67989 1.5142-3.21831 0-.33914-.9536-1.4284-1.4048-2.34247-.9703-1.45148.6899-2.96571-.8243-2.27575-2.2757.43449-.9141-.01669-2.0034-.97028-2.3425-1.51422-.5384-1.51422-2.67994.00001-3.21836.95358-.33914 1.40476-1.42841.97027-2.34248-.68996-1.45148.82427-2.9657 2.27575-2.27575.91407.4345 2.00333-.01669 2.34247-.97026z" clip-rule="evenodd"></path></g></svg>       
          <span class="lable-autogen">Générer Automatiquement</span>
        </button>
        
        <button class="button-analyze" id="analyzeHoursBtn">
          <svg class="svg-icon-analyze" xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 20 20" height="20" fill="none">
            <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M17.5 17.5V6.66667"></path>
            <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M12.5 17.5V2.5"></path>
            <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M7.5 17.5v-5.83333"></path>
            <path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M2.5 17.5v-9.16667"></path>
          </svg>        
          <span class="lable-analyze">MH Groupe</span>
        </button>
    
  </section>
    
    <section class="timetable-container">
      <table id="timetable">
        <thead>
          <tr>
            <th rowspan="2" colspan="2"></th>
            <th colspan="4" class="day-header lundi-day-header">Lundi</th>
            <th colspan="4" class="day-header mardi-day-header">Mardi</th>
            <th colspan="4" class="day-header mercredi-day-header">Mercredi</th>
            <th colspan="4" class="day-header jeudi-day-header">Jeudi</th>
            <th colspan="4" class="day-header vendredi-day-header">Vendredi</th>
            <th colspan="4" class="day-header samedi-day-header">Samedi</th>
          </tr>
          <tr>
            <!-- Lundi -->
            <th class="time-header lundi-session">S1</th>
            <th class="time-header lundi-session">S2</th>
            <th class="time-header lundi-session">S3</th>
            <th class="time-header lundi-session">S4</th>
            <!-- Mardi -->
            <th class="time-header mardi-session">S1</th>
            <th class="time-header mardi-session">S2</th>
            <th class="time-header mardi-session">S3</th>
            <th class="time-header mardi-session">S4</th>
            <!-- Mercredi -->
            <th class="time-header mercredi-session">S1</th>
            <th class="time-header mercredi-session">S2</th>
            <th class="time-header mercredi-session">S3</th>
            <th class="time-header mercredi-session">S4</th>
            <!-- Jeudi -->
            <th class="time-header jeudi-session">S1</th>
            <th class="time-header jeudi-session">S2</th>
            <th class="time-header jeudi-session">S3</th>
            <th class="time-header jeudi-session">S4</th>
            <!-- Vendredi -->
            <th class="time-header vendredi-session">S1</th>
            <th class="time-header vendredi-session">S2</th>
            <th class="time-header vendredi-session">S3</th>
            <th class="time-header vendredi-session">S4</th>
            <!-- Samedi -->
            <th class="time-header samedi-session">S1</th>
            <th class="time-header samedi-session">S2</th>
            <th class="time-header samedi-session">S3</th>
            <th class="time-header samedi-session">S4</th>
          </tr>
        </thead>
        <tbody>
          <!-- Généré dynamiquement -->
        </tbody>
      </table>
    </section>
    
    
    
  </div>
  
  <div class="excel-toolbar" id="excelToolbar">
    <button id="copyBtn" class="tooltip">
      <i class="fas fa-copy"></i> Copier <span class="keyboard-shortcut">Ctrl+C</span>
      <span class="tooltiptext">Copier les cellules sélectionnées</span>
    </button>
    <button id="pasteBtn" class="tooltip">
      <i class="fas fa-paste"></i> Coller <span class="keyboard-shortcut">Ctrl+V</span>
      <span class="tooltiptext">Coller dans les cellules sélectionnées</span>
    </button>
    <button id="cutBtn" class="tooltip">
      <i class="fas fa-cut"></i> Couper <span class="keyboard-shortcut">Ctrl+X</span>
      <span class="tooltiptext">Couper les cellules sélectionnées</span>
    </button>
    <button id="deleteBtn" class="tooltip">
      <i class="fas fa-trash-alt"></i> Supprimer <span class="keyboard-shortcut">Suppr</span>
      <span class="tooltiptext">Effacer le contenu des cellules</span>
    </button>
    <button id="clearSelectionBtn" class="tooltip">
      <i class="fas fa-times"></i> Annuler sélection
      <span class="tooltiptext">Désélectionner les cellules</span>
    </button>
  </div>
  
  <div class="paste-notification" id="pasteNotification"></div>
  
  <!-- NOUVELLE STRUCTURE HTML POUR LA NOTIFICATION -->
  <div id="notification" class="notification" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="notification__icon" id="notificationIcon">
        <i class="fas fa-check"></i>
    </div>
    <div class="notification__body">
        <h2 class="notification__header" id="notificationHeader">Success</h2>
        <p class="notification__text" id="notificationText">Your changes have been saved</p>
    </div>
    <div class="notification__action">
        <button id="notificationClose" class="button" aria-label="dismiss this notification">
            <span aria-hidden="true">✕</span>
        </button>
    </div>
  </div>


  <div id="weekLoader" class="loader-container" style="display: none;">
    <div class="loader">
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
    </div>
    <p>Chargement en cours...</p>
</div>

  <div id="autoGenModal" style="display: none; position: fixed; z-index: 1050; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5);">
    <div style="background-color: #fefefe; margin: 40px auto; padding: 10px; border: 1px solid #888; width: 90%; max-width: 1600px; max-height: 90vh; overflow-y: auto; border-radius: 10px;">

      <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;">
         <!--<h2 style="font-size: 1.8rem; color: #333;">Configuration de la Génération Automatique</h2>-->
         <div style="text-align: right; padding-top: 0px;">
          <button id="runAutoGenerateBtn" class="btn btn-save">Lancer la Génération</button>
        </div>
        <button id="closeModalBtn" style="background: none; border: none; font-size: 1.5rem; cursor: pointer;">×</button>
      </div>

      <div style="margin-bottom: 20px; font-size: 1.1rem; display: none; align-items: center;">
        <input type="checkbox" id="prefer5hBlocks" checked style="width: 20px; height: 20px; margin-right: 10px;">
        <label for="prefer5hBlocks">Privilégier les blocs de 5h (2 séances consécutives)</label>
    </div>
      
      <div id="autoGenConstraintsContainer" style="max-height: 400px; overflow-y: auto; padding-right: 15px;">
        <!-- Le contenu sera généré par JS -->
      </div>

      
    </div>
  </div>

  <button class="uiverse" id="voiceAssistantBtn" title="Activer l'assistant vocal">
    <div class="wrapper">
      <span><i class="fas fa-microphone"></i></span>
      <div class="circle circle-12"></div>
      <div class="circle circle-11"></div>
      <div class="circle circle-10"></div>
      <div class="circle circle-9"></div>
      <div class="circle circle-8"></div>
      <div class="circle circle-7"></div>
      <div class="circle circle-6"></div>
      <div class="circle circle-5"></div>
      <div class="circle circle-4"></div>
      <div class="circle circle-3"></div>
      <div class="circle circle-2"></div>
      <div class="circle circle-1"></div>
    </div>
  </button>
<div class="assistant-status" id="assistantStatus"></div>

<!-- ======================================================= -->
<!-- ==     MODALE AMÉLIORÉE AVEC GRAPHIQUE ET TABLEAU    == -->
<!-- ======================================================= -->
<div id="groupHoursModal" class="summary-modal" style="display: none;">
  <div class="summary-modal-content">
    <div class="summary-modal-header">
      <h2 id="groupHoursModalTitle">Répartition Horaire par Groupe</h2>
      <button id="closeGroupHoursModal" class="close-btn">&times;</button>
    </div>
    <div class="summary-modal-body">
      
      <!-- NOUVEL ÉLÉMENT CANVAS POUR LE GRAPHIQUE -->
      <div class="chart-container">
        <canvas id="groupHoursChartCanvas"></canvas>
      </div>
      
      <!-- Le conteneur du tableau reste pour le détail -->
      <div class="summary-table-container">
        <table id="groupHoursSummaryTable" style="display: none;">
          <thead>
            <tr>
              <th>Groupe</th>
              <th>Heures Affectées</th>
            </tr>
          </thead>
          <tbody id="groupHoursResultTbody">
            <!-- Le contenu sera généré par JavaScript -->
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>



  <script></script>
</body>
</html>