<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuration Initiale</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/fr.js"></script>
    <style>
        .step { display: none; }
        .step.active { display: block; animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* ---- AMÉLIORATIONS DE L'ANIMATION DU STEPPER ---- */

        /* 1. Animer la ligne de connexion */
        .stepper-item:not(:last-child)::after {
            content: '';
            @apply relative w-full h-0.5 bg-gray-300;
            top: -1.75rem;
            left: 50%;
            z-index: 1;
            /* Ajout d'une transition pour le changement de couleur */
            transition: background-color 0.4s ease-in-out;
        }
        .stepper-item.completed:not(:last-child)::after {
            @apply bg-blue-600;
        }

        /* 2. Animer le cercle de l'étape */
        .progress-circle {
            z-index: 10;
            /* Ajout de transitions pour la couleur et la taille pour un effet fluide et rebondissant */
            transition: background-color 0.4s ease-in-out, transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        
        /* 3. Ajouter un effet de zoom à l'étape active */
        .stepper-item.active .progress-circle {
            transform: scale(1.15);
        }
        
        /* ---- FIN DES AMÉLIORATIONS ---- */
        
        .date-input-container { position: relative; }
        .date-input-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #9ca3af; }
        input.date-picker { padding-left: 36px !important; }
        .tags-container { margin-top: 1rem; padding: 0.5rem; min-height: 80px; background-color: #f9fafb; border-radius: 0.375rem; border: 1px solid #e5e7eb; display: flex; flex-wrap: wrap; gap: 0.5rem; align-content: flex-start; }
        .tag { display: inline-flex; align-items: center; background-color: #e0e7ff; color: #4338ca; padding: 4px 12px; border-radius: 9999px; font-size: 0.875rem; font-weight: 500; }
        .tag button { margin-left: 8px; background: none; border: none; cursor: pointer; color: #6366f1; font-size: 1rem; line-height: 1; }
        .tag button:hover { color: #4338ca; }
        
        /* Styles pour l'ajout des espaces */
        .suggestion-item { padding: 8px 12px; cursor: pointer; }
        .suggestion-item:hover { background-color: #f3f4f6; }
        #suggestions-container { position: absolute; width: 100%; background: white; border: 1px solid #e5e7eb; border-radius: 0.375rem; box-shadow: 0 4px 6px rgba(0,0,0,0.05); max-height: 200px; overflow-y: auto; z-index: 20; }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
    <div class="w-full max-w-4xl bg-white p-6 md:p-8 rounded-xl shadow-lg">
        
        <div class="w-full px-4 sm:px-12 mb-12">
            <div class="flex items-start justify-between">
                <div id="progress-step-1" class="stepper-item relative flex flex-col justify-center items-center w-24">
                    <div id="progress-circle-1" class="progress-circle flex items-center justify-center w-10 h-10 bg-gray-300 text-gray-600 rounded-full font-bold"><span>1</span></div>
                    <div id="progress-label-1" class="mt-2 text-center text-sm font-semibold text-gray-500 transition-colors duration-300">Fichier</div>
                </div>
                <div id="progress-step-2" class="stepper-item relative flex flex-col justify-center items-center w-24">
                     <div id="progress-circle-2" class="progress-circle flex items-center justify-center w-10 h-10 bg-gray-300 text-gray-600 rounded-full font-bold"><span>2</span></div>
                    <div id="progress-label-2" class="mt-2 text-center text-sm font-semibold text-gray-500 transition-colors duration-300">Formateurs</div>
                </div>
                <div id="progress-step-3" class="stepper-item relative flex flex-col justify-center items-center w-24">
                     <div id="progress-circle-3" class="progress-circle flex items-center justify-center w-10 h-10 bg-gray-300 text-gray-600 rounded-full font-bold"><span>3</span></div>
                    <div id="progress-label-3" class="mt-2 text-center text-sm font-semibold text-gray-500 transition-colors duration-300">Calendrier</div>
                </div>
                <div id="progress-step-4" class="stepper-item relative flex flex-col justify-center items-center w-24">
                     <div id="progress-circle-4" class="progress-circle flex items-center justify-center w-10 h-10 bg-gray-300 text-gray-600 rounded-full font-bold"><span>4</span></div>
                    <div id="progress-label-4" class="mt-2 text-center text-sm font-semibold text-gray-500 transition-colors duration-300">Espaces</div>
                </div>
            </div>
        </div>
        
        <div id="step1" class="step active">
            <h2 class="text-2xl font-bold mb-4 text-center text-gray-800">Étape 1 : Importez votre fichier de base</h2>
            <p class="mb-6 text-gray-600 text-center">Veuillez sélectionner le fichier Excel "AvancementProgramme" fourni. Le système extraira automatiquement la liste de vos formateurs.</p>
            <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center bg-gray-50 hover:bg-gray-100 hover:border-blue-500 transition-all duration-300">
                <input type="file" id="excelFile" class="hidden" accept=".xlsx, .xls">
                <label for="excelFile" class="cursor-pointer"><i class="fas fa-cloud-upload-alt text-5xl text-blue-500 mb-4 inline-block"></i><p class="text-lg font-semibold text-gray-700">Cliquez pour choisir un fichier</p><p id="fileName" class="text-sm text-gray-500 mt-2 font-medium"></p></label>
            </div>
            <div id="step1-feedback" class="text-red-500 mt-4 text-center font-semibold"></div>
            <button id="step1NextBtn" class="w-full bg-blue-600 text-white p-3 rounded-lg mt-6 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-bold transition-all duration-300" disabled>Suivant <i class="fas fa-arrow-right"></i></button>
        </div>

        <div id="step2" class="step">
            <h2 class="text-2xl font-bold mb-4 text-center text-gray-800">Étape 2 : Vérifiez les informations des formateurs</h2>
            <p class="mb-6 text-gray-600 text-center">Les e-mails et matricules ont été générés automatiquement. Veuillez les vérifier et les corriger si nécessaire.</p>
            <div class="overflow-y-auto max-h-[50vh] border rounded-lg shadow-inner"><table class="w-full text-left"><thead class="bg-gray-100 sticky top-0"><tr><th class="p-3 font-semibold">Nom du Formateur</th><th class="p-3 font-semibold w-48">Masse Horaire Stat.</th><th class="p-3 font-semibold w-48">Matricule</th><th class="p-3 font-semibold">E-mail</th></tr></thead><tbody id="formateurs-table-body" class="divide-y divide-gray-200"></tbody></table></div>
            <div class="flex gap-4 mt-6"><button id="step2PrevBtn" class="w-1/3 bg-gray-200 text-gray-800 p-3 rounded-lg hover:bg-gray-300 font-bold transition-all duration-300">Précédent</button><button id="step2NextBtn" class="w-2/3 bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700 font-bold flex items-center justify-center gap-2 transition-all duration-300">Suivant <i class="fas fa-arrow-right"></i></button></div>
        </div>

        <div id="step3" class="step">
            <h2 class="text-2xl font-bold mb-4 text-center text-gray-800">Étape 3 : Configurez le calendrier de l'année</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-6">
                <div>
                    <label for="holidays-picker" class="block font-medium text-gray-700 mb-2">Jours fériés</label>
                    <div class="date-input-container"><i class="fas fa-calendar-day date-input-icon"></i><input type="text" id="holidays-picker" class="w-full p-2 border border-gray-300 rounded-md date-picker" placeholder="Sélectionnez les jours..."></div>
                    <div id="holidays-tags" class="tags-container"></div>
                </div>
                <div>
                    <label for="vacations-picker" class="block font-medium text-gray-700 mb-2">Périodes de vacances</label>
                    <div class="date-input-container"><i class="fas fa-calendar-week date-input-icon"></i><input type="text" id="vacations-picker" class="w-full p-2 border border-gray-300 rounded-md date-picker" placeholder="Sélectionnez une période..."></div>
                    <div id="vacations-tags" class="tags-container"></div>
                </div>
            </div>
             <div class="flex gap-4 mt-8"><button id="step3PrevBtn" class="w-1/3 bg-gray-200 text-gray-800 p-3 rounded-lg hover:bg-gray-300 font-bold">Précédent</button><button id="step3NextBtn" class="w-2/3 bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700 font-bold">Suivant <i class="fas fa-arrow-right"></i></button></div>
        </div>

        <div id="step4" class="step">
            <h2 class="text-2xl font-bold mb-4 text-center text-gray-800">Étape 4 : Listez vos espaces de travail</h2>
            <p class="mb-6 text-gray-600 text-center">Ajoutez vos salles, amphis, laboratoires, etc. N'oubliez pas d'inclure "TEAMS" pour les cours à distance.</p>
            
            <div class="relative">
                <div class="flex gap-2 mb-4">
                    <input type="text" id="espace-input" class="flex-grow p-3 border border-gray-300 rounded-md shadow-inner" placeholder="Salle A101">
                    <button id="ajouter-espace" class="bg-blue-600 text-white px-4 rounded-md hover:bg-blue-700 transition-colors">
                        <i class="fas fa-plus mr-1"></i> Ajouter
                    </button>
                </div>
                
                <div id="suggestions-container" class="hidden">
                    <!-- Suggestions seront ajoutées ici dynamiquement -->
                </div>
            </div>
            
            <div class="mt-4">
                <p class="text-sm text-gray-500 mb-2">Salles communes: 
                    <span id="common-spaces" class="inline-flex gap-2 ml-2">
                        <button class="text-blue-600 hover:text-blue-800 text-sm" data-space="Salle A101">Salle A101</button>
                        <button class="text-blue-600 hover:text-blue-800 text-sm" data-space="Amphi B">Amphi B</button>
                        <button class="text-blue-600 hover:text-blue-800 text-sm" data-space="Labo Info">Labo Info</button>
                        <button class="text-blue-600 hover:text-blue-800 text-sm" data-space="TEAMS">TEAMS</button>
                    </span>
                </p>
            </div>
            
            <div id="espaces-container" class="tags-container mt-4 min-h-[100px]"></div>
            
            <div id="step4-feedback" class="text-red-500 mt-4 text-center font-semibold"></div>
            <div class="flex gap-4 mt-6">
                <button id="step4PrevBtn" class="w-1/3 bg-gray-200 text-gray-800 p-3 rounded-lg hover:bg-gray-300 font-bold">Précédent</button>
                <button id="finishSetupBtn" class="w-2/3 bg-green-600 text-white p-3 rounded-lg hover:bg-green-700 font-bold flex items-center justify-center gap-2 transition-all duration-300">
                    Terminer et Sauvegarder <i class="fas fa-check"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        async function checkSessionAndLoad() {
            try {
                const response = await fetch('../api/auth/verify_session.php');
                const result = await response.json();
                if (!result.success) {
                    window.location.href = 'login.html';
                } else {
                    initializeSetupPage();
                }
            } catch (error) {
                window.location.href = 'login.html';
            }
        }
        document.addEventListener('DOMContentLoaded', checkSessionAndLoad);

        function initializeSetupPage() {
            const steps = [document.getElementById('step1'), document.getElementById('step2'), document.getElementById('step3'), document.getElementById('step4')];
            const fileInput = document.getElementById('excelFile');
            const fileNameLabel = document.getElementById('fileName');
            const formateursTableBody = document.getElementById('formateurs-table-body');
            const feedbacks = { step1: document.getElementById('step1-feedback'), step4: document.getElementById('step4-feedback') };
            let rawExcelData = null;

            const nextButtons = { 1: document.getElementById('step1NextBtn'), 2: document.getElementById('step2NextBtn'), 3: document.getElementById('step3NextBtn') };
            const prevButtons = { 2: document.getElementById('step2PrevBtn'), 3: document.getElementById('step3PrevBtn'), 4: document.getElementById('step4PrevBtn') };

            function goToStep(stepNumber) {
                steps.forEach((step, index) => step.classList.toggle('active', (index + 1) === stepNumber));
                updateProgress(stepNumber);
            }

            // --- FONCTION `updateProgress` AMÉLIORÉE ---
            function updateProgress(currentStep) {
                for (let i = 1; i <= 4; i++) {
                    const stepEl = document.getElementById(`progress-step-${i}`);
                    const circleEl = document.getElementById(`progress-circle-${i}`);
                    const labelEl = document.getElementById(`progress-label-${i}`);

                    // Réinitialiser les états visuels
                    stepEl.classList.remove('completed', 'active');
                    circleEl.classList.remove('bg-blue-600', 'text-white');
                    labelEl.classList.remove('font-bold', 'text-blue-600');
                    
                    // Appliquer l'état par défaut (pour les étapes futures)
                    circleEl.classList.add('bg-gray-300', 'text-gray-600');
                    labelEl.classList.add('font-semibold', 'text-gray-500');

                    if (i < currentStep) {
                        // Marquer les étapes passées comme "complétées"
                        stepEl.classList.add('completed');
                        circleEl.classList.add('bg-blue-600', 'text-white');
                        labelEl.classList.add('font-semibold', 'text-gray-700'); 
                    } else if (i === currentStep) {
                        // Marquer l'étape actuelle comme "complétée" et "active"
                        stepEl.classList.add('completed', 'active');
                        circleEl.classList.add('bg-blue-600', 'text-white');
                        labelEl.classList.add('font-bold', 'text-blue-600');
                    }
                }
            }


            // --- LOGIQUE POUR L'ÉTAPE 3 (Calendrier) ---
            const holidaysTagsContainer = document.getElementById('holidays-tags');
            const vacationsTagsContainer = document.getElementById('vacations-tags');
            
            const currentYear = new Date().getFullYear();

            async function fetchMoroccanHolidays(year) {
                try {
                    const response = await fetch(`https://date.nager.at/api/v3/PublicHolidays/${year}/MA`);
                    if (!response.ok) {
                        console.error("Impossible de récupérer les jours fériés.");
                        return [];
                    }
                    const holidays = await response.json();
                    
                    return holidays.map(holiday => {
                        const date = new Date(holiday.date);
                        const day = String(date.getDate()).padStart(2, '0');
                        const month = String(date.getMonth() + 1).padStart(2, '0');
                        const year = date.getFullYear();
                        return `${day}/${month}/${year}`;
                    });
                } catch (error) {
                    console.error("Erreur lors de la récupération des jours fériés:", error);
                    return [];
                }
            }
            
            const holidaysPicker = flatpickr("#holidays-picker", {
                mode: "multiple",
                dateFormat: "d/m/Y",
                locale: "fr",
                onChange: function(selectedDates) {
                    const dateStrings = selectedDates.map(d => holidaysPicker.formatDate(d, "d/m/Y"));
                    updateTags('holidays', dateStrings);
                }
            });

            const vacationsPicker = flatpickr("#vacations-picker", {
                mode: "range",
                dateFormat: "d/m/Y",
                locale: "fr",
                onClose: function(selectedDates) {
                    if (selectedDates.length === 2) {
                        const rangeStr = `${vacationsPicker.formatDate(selectedDates[0], "d/m/Y")} - ${vacationsPicker.formatDate(selectedDates[1], "d/m/Y")}`;
                        addTag('vacations', rangeStr);
                        vacationsPicker.clear();
                    }
                }
            });

            fetchMoroccanHolidays(currentYear).then(holidayDates => {
                if (holidayDates.length > 0) {
                    holidaysPicker.setDate(holidayDates, true);
                }
            });

            // --- LOGIQUE POUR L'ÉTAPE 4 (Espaces) ---
            const espaceInput = document.getElementById('espace-input');
            const ajouterEspaceBtn = document.getElementById('ajouter-espace');
            const espacesContainer = document.getElementById('espaces-container');
            const commonSpacesContainer = document.getElementById('common-spaces');
            const suggestionsContainer = document.getElementById('suggestions-container');
            
            const commonSpaces = [
                'Salle A101', 'Salle A102', 'Salle A103',
                'Amphi A', 'Amphi B', 'Amphi C',
                'Labo Informatique', 'Labo Physique', 'Labo Chimie',
                'Salle de réunion', 'Bibliothèque', 'Atelier',
                'TEAMS', 'ZOOM', 'DISTANCIEL'
            ];
            
            function ajouterEspace(espace) {
                espace = espace.trim();
                if (!espace) return;
                
                const existingSpaces = Array.from(espacesContainer.querySelectorAll('.tag')).map(tag => tag.dataset.value);
                if (existingSpaces.includes(espace)) {
                    feedbacks.step4.textContent = "Cet espace a déjà été ajouté.";
                    return;
                }
                
                const tag = document.createElement('span');
                tag.className = 'tag';
                tag.dataset.value = espace;
                tag.innerHTML = `${espace} <button type="button" class="delete-btn"><i class="fas fa-times"></i></button>`;
                tag.querySelector('.delete-btn').onclick = () => tag.remove();
                espacesContainer.appendChild(tag);
                
                espaceInput.value = '';
                suggestionsContainer.classList.add('hidden');
                feedbacks.step4.textContent = '';
            }
            
            ajouterEspaceBtn.addEventListener('click', () => {
                ajouterEspace(espaceInput.value);
            });
            
            espaceInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    ajouterEspace(espaceInput.value);
                }
            });
            
            commonSpacesContainer.querySelectorAll('button').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    ajouterEspace(e.target.dataset.space);
                });
            });
            
            espaceInput.addEventListener('input', () => {
                const value = espaceInput.value.trim().toLowerCase();
                if (value.length < 2) {
                    suggestionsContainer.classList.add('hidden');
                    return;
                }
                
                const suggestions = commonSpaces.filter(space => 
                    space.toLowerCase().includes(value)
                );
                
                if (suggestions.length === 0) {
                    suggestionsContainer.classList.add('hidden');
                    return;
                }
                
                suggestionsContainer.innerHTML = '';
                suggestions.forEach(space => {
                    const item = document.createElement('div');
                    item.className = 'suggestion-item';
                    item.textContent = space;
                    item.onclick = () => {
                        ajouterEspace(space);
                        suggestionsContainer.classList.add('hidden');
                    };
                    suggestionsContainer.appendChild(item);
                });
                
                suggestionsContainer.classList.remove('hidden');
            });
            
            document.addEventListener('click', (e) => {
                if (!suggestionsContainer.contains(e.target) && e.target !== espaceInput) {
                    suggestionsContainer.classList.add('hidden');
                }
            });

            function updateTags(type, values) {
                document.getElementById(`${type}-tags`).innerHTML = '';
                values.forEach(value => addTag(type, value, false));
            }

            function addTag(type, value, updatePicker = true) {
                const container = document.getElementById(`${type}-tags`);
                if (Array.from(container.querySelectorAll('.tag')).find(t => t.dataset.value === value)) return;
                const tag = document.createElement('span');
                tag.className = 'tag';
                tag.dataset.value = value;
                tag.innerHTML = `${value} <button type="button">×</button>`;
                tag.querySelector('button').onclick = () => {
                    tag.remove();
                    if (type === 'holidays' && updatePicker) holidaysPicker.setDate(getTagsValues('holidays'), true);
                };
                container.appendChild(tag);
            }
            
            function getTagsValues(type) {
                return Array.from(document.getElementById(`${type}-tags`).querySelectorAll('.tag')).map(t => t.dataset.value);
            }
            
            nextButtons[1].addEventListener('click', () => handleStep1Next());
            nextButtons[2].addEventListener('click', () => goToStep(3));
            nextButtons[3].addEventListener('click', () => goToStep(4));
            prevButtons[2].addEventListener('click', () => goToStep(1));
            prevButtons[3].addEventListener('click', () => goToStep(2));
            prevButtons[4].addEventListener('click', () => goToStep(3));

            fileInput.addEventListener('change', function() {
                if (this.files.length > 0) {
                    fileNameLabel.textContent = this.files[0].name;
                    nextButtons[1].disabled = false;
                }
            });

            function handleStep1Next() {
                const formData = new FormData();
                formData.append('excelFile', fileInput.files[0]);
                nextButtons[1].innerHTML = 'Analyse... <i class="fas fa-spinner fa-spin"></i>';
                nextButtons[1].disabled = true;
                fetch('../api/setup/parse_formateurs.php', { method: 'POST', body: formData })
                    .then(response => response.json())
                    .then(result => {
                        if (result.success) {
                            rawExcelData = result.rawExcelData;
                            populateFormateursTable(result.formateurs);
                            goToStep(2);
                        } else {
                            feedbacks.step1.textContent = result.message || "Erreur d'analyse.";
                        }
                    }).finally(() => {
                        nextButtons[1].innerHTML = 'Suivant <i class="fas fa-arrow-right"></i>';
                    });
            }

            function populateFormateursTable(formateurs) {
                formateursTableBody.innerHTML = '';
                formateurs.forEach(f => {
                    const row = document.createElement('tr');
                    row.className = "hover:bg-gray-50 transition-colors duration-200";
                    row.innerHTML = `<td class="p-3 font-semibold text-gray-800 nom">${f.nom}</td><td class="p-3"><input type="number" class="w-full p-2 border rounded masse_horaire" value="${f.masse_horaire}"></td><td class="p-3"><input type="text" class="w-full p-2 border rounded bg-gray-100 matricule" value="${f.matricule}" readonly></td><td class="p-3"><input type="email" class="w-full p-2 border rounded email" value="${f.email}" placeholder="E-mail personnel si vacataire"></td>`;
                    formateursTableBody.appendChild(row);
                });
            }

            const finishSetupBtn = document.getElementById('finishSetupBtn');
            finishSetupBtn.addEventListener('click', function() {
                const formateursData = Array.from(formateursTableBody.querySelectorAll('tr')).map(row => ({
                    nom: row.querySelector('.nom').textContent,
                    masse_horaire: row.querySelector('.masse_horaire').value,
                    matricule: row.querySelector('.matricule').value,
                    email: row.querySelector('.email').value
                }));

                const espaces = Array.from(espacesContainer.querySelectorAll('.tag')).map(tag => tag.dataset.value);
                
                if (espaces.length === 0) {
                    feedbacks.step4.textContent = "Veuillez ajouter au moins un espace de travail.";
                    return;
                }

                const finalData = {
                    excelData: rawExcelData,
                    formateursData: formateursData,
                    holidays: getTagsValues('holidays'),
                    vacations: getTagsValues('vacations'),
                    espaces: espaces
                };

                this.innerHTML = 'Sauvegarde... <i class="fas fa-spinner fa-spin"></i>';
                this.disabled = true;

                fetch('../api/setup/complete_setup.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(finalData)
                })
                .then(response => response.json())
                .then(result => {
                    if (result.success) {
                        const circleEl = document.getElementById(`progress-circle-4`);
                        const stepEl = document.getElementById(`progress-step-4`);
                        circleEl.classList.remove('bg-blue-600');
                        circleEl.classList.add('bg-green-600');
                        stepEl.classList.add('completed');
                        setTimeout(() => { window.location.href = 'admin.html'; }, 1000);
                    } else {
                        feedbacks.step4.textContent = result.message || "Erreur lors de la sauvegarde.";
                        this.innerHTML = 'Terminer et Sauvegarder <i class="fas fa-check"></i>';
                        this.disabled = false;
                    }
                })
                .catch(error => {
                    console.error('Final setup error:', error);
                    feedbacks.step4.textContent = "Erreur de communication avec le serveur.";
                    this.innerHTML = 'Terminer et Sauvegarder <i class="fas fa-check"></i>';
                    this.disabled = false;
                });
            });
            goToStep(1);
        }
    </script>
</body>
</html>